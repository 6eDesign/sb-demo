!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t():"function"==typeof define&&define.amd?define(t):t()}(0,function(){"use strict";var n,d="FIRST_IN_STRING",s="COLON_SEPARATED_SECOND_GROUP",l="COLON_SEPARATED_THIRD_GROUP",u=function(e){var t=typeof e;switch(t){case"object":return null==e?"null":e instanceof Array?"array":t;default:return t}},e=(n=0,function(e,t){clearTimeout(n),n=setTimeout(e,t)}),c=function(e){for(var t=[],n=0;n<e.length;++n){switch(u(e[n])){case"object":t.push(p({},e[n]));break;case"array":t.push(c(e[n]));break;default:t.push(e[n])}}return t},p=function(){for(var e=arguments,t=1,n=arguments.length;t<n;++t){var i=e[t],r=e[0];for(var o in i){var a="array"===u(i[o]),d="object"!=u(r[o])&&"object"!=u(i[o])&&!a;r[o]=d?i[o]:(r[o]=p(void 0===r[o]?{}:r[o],i[o]),a?c(i[o]):p(void 0===r[o]?{}:r[o],i[o]))}}return arguments.length?arguments[0]:{}},o=function(e){if(Object.keys)return Object.keys(e);for(var t in arr=[],e)arr.push(t);return arr},b=function(e){var t,n,i={};t=a(e),n=o(t);for(var r=0;r<n.length;++r)0===n[r].indexOf("data-")&&(i[n[r].substring(5,n[r].length)]=t[n[r]]);return i},a=function(e){var t,n={};t=e.attributes;for(var i=0;i<t.length;++i){var r=t.item(i);n[r.nodeName]=r.hasOwnProperty("value")?r.value:r.nodeValue}return n};var t=Object.freeze({delay:e,extend:p,getKeys:o,getData:b,getAttrs:a,set:function(e,t,n){for(var i=(t=t.split(".")).pop();t.length;){var r=t.shift();e[r]=void 0===e[r]?{}:e[r],e=e[r]}e[i]=n},get:function(e,t){if("$base"==t||""===t)return e;t=t.split(".");for(var n=0;n<t.length;++n){if("$base"==t[n])return e;if(null==e)return"";if(void 0===e[t[n]])return"";if(null===e)return"";e=e[t[n]]}return e},replaceObjNameInBindingStr:function(e,t,n,i){return e.split(",").map((r=t.objNameLocation,o=n,a=i,function(e){switch(r){case d:return e=e.replace(new RegExp("^"+o+"(.)?"),a+"$1");case s:return e=e.replace(new RegExp("^([^:]+:)"+o+"(\\.)?"),"$1"+a+"$2");case l:return e=e.replace(new RegExp("^([^:]+:[^:]+:)"+o+"(\\.)?"),"$1"+a+"$2")}})).join(",");var r,o,a},triggerEvent:function(e,t){if("createEvent"in document){var n=document.createEvent("HTMLEvents");n.initEvent(t,!1,!0),e.dispatchEvent(n)}else e.fireEvent("on"+t)}}),m={bindTypes:[],bindTypeOpts:{},boundElems:{},boundObjects:{},boundObjectsLast:{},ready:!1,beforeReadyBindQueue:[],autoReBinding:!1,autoReBindingQueue:{},plugins:[]},f=document,i=function(e,t){void 0===t&&(t=!1),t&&(m.autoReBinding=!0,m.autoReBindingQueue={});for(var n=(e=void 0===e?f:e).getElementsByTagName("*"),i=0;i<n.length;++i){var r=b(n[i]);if(void 0===r.simplebindcollected)for(var o=!1,a=0;a<m.bindTypes.length;++a)void 0!==r[m.bindTypes[a]]&&(o||(o=!0,n[i].setAttribute("data-simplebindcollected","true")),r.bindType=m.bindTypes[a],m.bindTypeOpts[m.bindTypes[a]].collection(n[i],r))}t&&(m.autoReBinding=!1,v())},r=function(e,t,n){n=void 0!==n&&n;for(var i=0;i<e.length;++i)m.bindTypeOpts[e[i].bindType].binding&&m.bindTypeOpts[e[i].bindType].binding(e[i],t,n)},v=function(){for(var e in m.autoReBindingQueue)void 0!==m.boundObjects[e]&&r(m.autoReBindingQueue[e],m.boundObjects[e],!0)},g=function(t){for(var n=[],e=arguments.length-1;0<e--;)n[e]=arguments[e+1];switch(t){case"preBind":case"postBind":var i=n[1];return m.plugins.forEach(function(e){return i="function"==typeof e[t]?e[t].apply(null,n):i}),i}};f.addEventListener("DOMContentLoaded",function(){!function(){if(i(),m.ready=!0,m.beforeReadyBindQueue.length)for(var e=0;e<m.beforeReadyBindQueue.length;++e)h.bind(m.beforeReadyBindQueue[e].name,m.beforeReadyBindQueue[e].obj)}()});var h=window.simpleBind||{};h.util=t,h.getState=function(){return m};var y={binding:null};h.registerBindType=function(e,t){void 0===m.bindTypeOpts[e]&&(m.bindTypeOpts[e]={},m.bindTypes.push(e)),p(m.bindTypeOpts[e],y,t)},h.addToBoundElems=function(e,t,n){n.bindType=e,void 0===m.boundElems[t]&&(m.boundElems[t]=[]),m.autoReBinding&&(void 0===m.autoReBindingQueue[t]&&(m.autoReBindingQueue[t]=[]),m.autoReBindingQueue[t].push(n)),m.boundElems[t].push(n)},h.recollectDOM=function(e,t){i(e,t)};var j={preBind:null,postBind:null,name:""};h.registerPlugin=function(e){void 0===e&&(e={}),m.plugins.push(p({},j,e))},h.bind=function(e,t){var n,i;"string"==typeof e&&void 0!==t&&(void 0===m.boundElems[e]&&(m.boundElems[e]=[]),m.ready?(t=g("preBind",e,t),n=e,i=t,void 0===m.boundObjectsLast[n]&&(m.boundObjectsLast[n]={}),m.boundObjects[n]=i,void 0!==m.boundElems[n]&&(r(m.boundElems[n],i),m.boundObjectsLast[n]=p({},i)),t=g("postBind",e,t)):m.beforeReadyBindQueue.push({name:e,obj:t}))},h.extendNamespace=function(e,t){h[e]=t};h.registerBindType("simplebind",{collection:function(e,t){t.simplebind=t.simplebind.split(".");var n={elem:e,objName:t.simplebind.shift(),objKey:t.simplebind.join("."),opts:t};h.addToBoundElems("simplebind",n.objName,n)},binding:function(e,t,n){var i=h.util.get(t,e.objKey);(i!==h.util.get(m.boundObjectsLast[e.objName],e.objKey)||n)&&(void 0!==e.opts.simplefilter&&(i=h.getFilteredValue(i,e.opts.simplefilter)),i="string"==typeof i?i:JSON.stringify(i,null,2),void 0!==e.opts.simplebindhtml&&"true"==e.opts.simplebindhtml?e.elem.innerHTML=i:e.elem.childNodes.length?e.elem.childNodes[0].nodeValue=i:e.elem.appendChild(document.createTextNode(i)))},objNameLocation:d}),m.bindHandlers={};h.registerBindType("simplebindhandler",{collection:function(e,t){for(var n=t.simplebindhandler.split(","),i=0;i<n.length;++i){n[i]=n[i].split(":");var r={elem:e,handler:n[i].shift()};n[i]=n[i].shift().split("."),r.objName=n[i].shift(),r.objKey=n[i].join("."),h.addToBoundElems("simplebindhandler",r.objName,r)}},binding:function(e,t,n){if(void 0!==m.bindHandlers[e.handler]){var i=h.util.get(t,e.objKey),r=h.util.get(m.boundObjectsLast[e.objName],e.objKey);(("object"==typeof i?JSON.stringify(i)!=JSON.stringify(r):i!=r)||n)&&m.bindHandlers[e.handler](e.elem,h.util.get(t,e.objKey),e.objName)}},objNameLocation:s}),h.extendNamespace("registerBindHandler",function(e,t){"function"==typeof t&&(m.bindHandlers[e]=t)});var T="data-simpleeventdispatch",O="data-simplebindvaluechanger",E=function(){if(this.getAttribute(T))return this.removeAttribute(T);var e=this.getAttribute("data-simplebindvalue").split("."),t=e.shift();if(void 0===m.boundObjects[t]&&(m.boundObjects[t]={}),this.setAttribute(O,"true"),h.util.set(m.boundObjects[t],e.join("."),w(this)),h.bind(t,m.boundObjects[t]),-1<t.indexOf("__repeat")){var n=m.repeatDictionary[t.split("-").shift()];h.bind(n,m.boundObjects[n])}},N=function(){var e=this;h.util.delay(function(){E.call(e)},50)},B=function(e){var t=e.tagName.toLowerCase();switch(t){case"input":return e.getAttribute("type");default:return t}},w=function(e){switch(B(e)){case"checkbox":return e.checked;default:return e.value}};h.registerBindType("simplebindvalue",{collection:function(e,t){t.simplebindvalue=t.simplebindvalue.split(".");var n={elem:e,objName:t.simplebindvalue.shift(),objKey:t.simplebindvalue.join("."),inputType:B(e),initiatedChange:!1};!function(e,t){switch(t){case"text":case"tel":case"password":case"textarea":case"number":case"email":case"zip":case"time":e.addEventListener("keyup",N);default:e.addEventListener("change",E)}}(e,n.inputType),h.addToBoundElems("simplebindvalue",n.objName,n)},binding:function(e,t,n){var i=h.util.get(t,e.objKey);!function(e,t){switch(B(e)){case"checkbox":return String(e.checked)!=String(t);case"radio":var n=w(e);return e.checked&&n!=String(t)||!e.checked&&n==String(t);default:return t!=w(e)}}(e.elem,i)?e.elem.getAttribute(O)&&e.elem.removeAttribute(O):e.elem.getAttribute(O)?e.elem.removeAttribute(O):(function(e,t){switch(e.inputType){case"select":for(var n=e.elem.getElementsByTagName("option"),i=0,r=0;r<n.length;++r)if(n[r].value==t){i=r;break}e.elem.selectedIndex=i;break;case"radio":e.elem.checked=String(t)==e.elem.value;break;case"checkbox":e.elem.checked=!0===t||"true"==t;break;case"textarea":e.elem.innerHTML!=t&&(e.elem.innerHTML=t);break;case"text":default:(t!=e.elem.value||flush)&&(e.elem.value=t)}}(e,i),e.elem.setAttribute(T,"true"),h.util.triggerEvent(e.elem,"change"))},objNameLocation:d}),m.repeatCount=0,m.repeatDictionary={};var L=function(e,t){return"__repeat"+e.repeatIndex+"-"+e.innerObjName+t},x=function(e,t,n){for(var i=0;i<e.length;++i)for(var r=0;r<m.bindTypes.length;++r){var o="data-"+m.bindTypes[r],a=e[i].getAttribute(o);if(a){var d=h.util.replaceObjNameInBindingStr(a,m.bindTypeOpts[m.bindTypes[r]],t,n);d!=a&&e[i].setAttribute(o,d),e[i].removeAttribute("data-simplebindcollected")}}};h.registerBindType("simplerepeat",{collection:function(e,t){t.simplerepeat=t.simplerepeat.split(":");var n=t.simplerepeat.pop().split("."),i={elem:e,objName:n.shift(),objKey:n.join("."),innerObjName:t.simplerepeat.shift(),repeatedElems:[],repeatIndex:m.repeatCount},r=e.getElementsByTagName("*");x(r,i.innerObjName,L(i,0)),i.repeatTemplate=r[0].parentNode.removeChild(r[0]),m.repeatDictionary["__repeat"+i.repeatIndex]=i.objName,++m.repeatCount,h.addToBoundElems("simplerepeat",i.objName,i)},binding:function(e,t,n){var i=h.util.get(t,e.objKey)||[];if(void 0!==i.length){!function(e,t){var n;if(e.repeatedElems.length!=t)if(e.repeatedElems.length<t){n=t-e.repeatedElems.length;for(var i=document.createDocumentFragment(),r=0;r<n;++r){var o=e.repeatTemplate.cloneNode(!0),a=o.getElementsByTagName("*"),d=L(e,0),s=L(e,e.repeatedElems.length);x([o],d,s),x(a,d,s),e.repeatedElems.push(o),i.appendChild(o)}e.elem.appendChild(i),h.recollectDOM(e.elem,!0)}else for(n=e.repeatedElems.length-t,r=0;r<n;++r){var l=e.repeatedElems.pop(),u=L(e,e.repeatedElems.length);l.parentNode.removeChild(l),void 0!==m.boundElems[u]&&delete m.boundElems[u],void 0!==m.boundObjects[u]&&delete m.boundObjects[u],void 0!==m.boundObjectsLast[u]&&delete m.boundObjectsLast[u]}}(e,i.length);for(var r=0;r<i.length;++r)h.bind(L(e,r),i[r])}},objNameLocation:s}),h.extendNamespace("rewriteBindings",x),m.eventHandlers={};var k=function(e,t,n,i,r,o){e.addEventListener(t,function(e){if(void 0!==m.eventHandlers[n])return i&&void 0!==m.boundObjects[r]?void m.eventHandlers[n].call(this,e,h.util.get(m.boundObjects[r],o)):m.eventHandlers[n].call(this,e,void 0)})};h.registerBindType("simpleevent",{collection:function(e,t){for(var n=t.simpleevent.split(","),i=0;i<n.length;++i){var r=n[i].split(":"),o=r.shift(),a=r.shift(),d=!!r.length&&r.shift().split(".");if(d){var s=d.shift(),l=d.join(".");k(e,o,a,d,s,l)}else k(e,o,a,d)}},binding:null,objNameLocation:l}),h.extendNamespace("registerEvent",function(e,t){m.eventHandlers[e]=t});h.registerBindType("simplebindattrs",{collection:function(e,t){for(var n=t.simplebindattrs.split(","),i=0;i<n.length;++i){n[i]=n[i].split(":");var r={elem:e,attr:n[i].shift()};n[i]=n[i].shift().split("."),r.objName=n[i].shift(),r.objKey=n[i].join("."),h.addToBoundElems("simplebindattrs",r.objName,r)}},binding:function(e,t,n){var i=h.util.get(t,e.objKey);(i!=h.util.get(m.boundObjectsLast[e.objName],e.objKey)||n)&&e.elem.setAttribute(e.attr,i)},objNameLocation:s});h.registerBindType("simpledata",{collection:function(e,t){for(var n=t.simpledata.split(","),i=0;i<n.length;++i){var r=n[i].split(":"),o=r.shift(),a={elem:e,objName:(r=r.shift().split(".")).shift(),objKey:r.join("."),prop:o};h.addToBoundElems("simpledata",a.objName,a)}},binding:function(e,t){var n="data-"+e.prop.replace(/\W+/g,"-").replace(/([a-z\d])([A-Z])/g,"$1-$2");e.elem.setAttribute(n,h.util.get(t,e.objKey))},objNameLocation:s}),m.filters={};h.extendNamespace("getFilteredValue",function(e,t){t=t.split(",");for(var n=0;n<t.length;++n)void 0!==m.filters[t[n]]&&(e=m.filters[t[n]](e));return e}),h.extendNamespace("registerFilter",function(e,t){"function"==typeof t&&(m.filters[e]=t)});var R,_=h.bind,D=h.registerPlugin,A=h.util,S=h.getState(),C=void 0!==window.__REDUX_DEVTOOLS_EXTENSION__,H=!1;C&&(R=window.__REDUX_DEVTOOLS_EXTENSION__.connect({latency:0})).subscribe(function(e){for(var t=[],n=arguments.length-1;0<n--;)t[n]=arguments[n+1];if("DISPATCH"===e.type&&e.state){var i=JSON.parse(e.state);for(var r in i)H=!0,_(r,i[r])}});var I=function(e){return 0==e.indexOf("__repeat")};D({name:"reduxDevToolsConnector",postBind:function(e,t){if(!I(e)){var n,i=0==H;return H&&(H=!1),!I(e)&&i&&R.send(e+"-bound",(S.boundObjects,n=A.extend({},S.boundObjects),Object.keys(n).filter(I).forEach(function(e){return delete n[e]}),n)),t}}});var K={newItem:{text:"",priority:"low"},tasks:[{id:(new Date).getTime(),description:"use rollup to build simplebind.js",completed:!0,priority:"high"},{id:(new Date).getTime()+1,description:"make it easier to create new simplebind bind types",completed:!0,priority:"high"},{id:(new Date).getTime()+2,description:"use some es6 via buble",completed:!0,priority:"high"},{id:(new Date).getTime()+3,description:"make simpleBind smaller with tree shaking",completed:!0,priority:"high"}]};h.registerEvent("addNewItem",function(e,t){t.text&&(K.tasks.push({id:(new Date).getTime(),completed:!1,priority:t.priority,description:t.text}),K.newItem.text="",h.bind("todo",K)),e.preventDefault()});h.registerEvent("removeItem",function(e,t){var n,i;console.log(K,t),K.tasks=K.tasks.filter((n="id",i=t,function(e){return console.log(e[n]+" vs "+i),e[n]!==i})),h.bind("todo",K)}),h.registerEvent("removeCompleted",function(e){for(var t=0,n=K.tasks.length,i=0;i<n;++i)K.tasks[i-t].completed&&(K.tasks.splice(i-t,1),++t);t&&h.bind("todo",K)}),h.registerBindHandler("taskCompletedHandler",function(e,t){e.className=t?"complete":""});window,document.addEventListener("DOMContentLoaded",function(){h.bind("todo",K)})});
//# sourceMappingURL=todo.js.map
